{"version":3,"file":"vue.js","sources":["../src/utils.js","../src/observer/array.js","../src/observer/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["export function isFunction(val) {\n  return typeof val === 'function'\n}\nexport function isObject(val) {\n  return Object.prototype.toString.call(val) === '[object Object]' || val === null\n}","let oldArrayPrototype = Array.prototype\r\nexport let arrayMethods = Object.create(oldArrayPrototype)\r\nlet methods = [\r\n  'push',\r\n  'pop',\r\n  'shift',\r\n  'unshift',\r\n  'splice',\r\n  'reverse',\r\n  'sort'\r\n]\r\nmethods.forEach(method => {\r\n  // 重写数组上的方法\r\n  arrayMethods[method] = function(...args) {\r\n    oldArrayPrototype[method].call(this, ...args)\r\n    let insert\r\n    let ob = this.__ob__\r\n    switch(method) {\r\n      case 'unshift':\r\n        insert = args\r\n        break\r\n      case 'push':\r\n        insert = args\r\n        break\r\n      case 'splice':\r\n        insert = args.slice(2)\r\n    }\r\n    if (insert) {\r\n      ob.observeArray(insert)\r\n    }\r\n  }\r\n})","import { isObject } from \"../utils\"\nimport { arrayMethods } from \"./array\"\n\n// 通过类来检测数据，类有类型\nclass Observer {\n  constructor(data) { // 对对象中的所有属性进行劫持\n    // 将Observer实例赋值给data的ob属性，方便对数组劫持的时候调用Observe，同时可以判断如果一个数据有ob属性，说明它已经被劫持过了\n    Object.defineProperty(data,' __ob__', {\n      value: this,\n      enumerable: false\n    })\n    if (Array.isArray(data)) {\n      data.__proto__ = arrayMethods\n      // 如果数组的的子元素为对象需要对该子元素进行劫持\n      this.observeArray(data)\n    } else {\n      this.walk(data)\n    }\n  }\n  observeArray(data) {\n    data.forEach(ele => {\n      observe(ele)\n    })\n  }\n  walk(data) {\n    Object.keys(data).forEach(key => {\n      defineReactive(data, key, data[key])\n    })\n  }\n}\n// 对对象的属性进行遍历，用defineProperty对对象的数据进行劫持\nfunction defineReactive(data, key, value) {\n  // 如果对象中的属性还是对象则需要递归调用监测方法\n  observe(value)\n  Object.defineProperty(data, key, {\n    get() {\n      return value\n    },\n    set(newV) {\n      observe(newV) // 如果给对象的属性复制的是一个新对象，则需要对新对象重新劫持\n      value = newV\n    }\n  })\n}\nexport function observe(data) {\n  if (!isObject(data)) {\n    return\n  }\n  if (data.__ob__) {\n    return\n  }\n  new Observer(data)\n}","import { observe } from \"./observer/index\"\nimport { isFunction } from \"./utils\"\n\nexport function initState(vm) { // 状态初始化\n  const opts = vm.$options\n  if (opts.data) {\n    initData(vm)\n  }\n}\nfunction proxy(vm, source, key) {\n  Object.defineProperty(vm, key, {\n    get() {\n      return vm[source][key]\n    },\n    set(newV) {\n      vm[source][key] = newV\n    }\n  })\n}\nfunction initData(vm) {\n  let data = vm.$options.data\n  // 将劫持的数据放在实例的_data上\n  data = vm._data = isFunction(data) ? data.call(vm) : data;\n  // 对数据做一层代理\n  for (let key in data) {\n    proxy(vm, '_data', key)\n  }\n  observe(data)\n}","import { initState } from \"./state\"\n\n// 在vue的基础上做一次混合操作，为vue原型添加方法\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this\n    vm.$options = options //方便对options进行扩展\n\n    // 对数据进行初始化 data watch computed\n    initState(vm)\n  }\n}","import { initMixin } from \"./init\"\n\nfunction Vue(options) {\n  // 初始化Vue实例的配置\n  this._init(options)\n}\n// 扩展原型\ninitMixin(Vue)\nexport default Vue"],"names":["isFunction","val","isObject","Object","prototype","toString","call","oldArrayPrototype","Array","arrayMethods","create","methods","forEach","method","args","insert","ob","__ob__","slice","observeArray","Observer","data","defineProperty","value","enumerable","isArray","__proto__","walk","ele","observe","keys","key","defineReactive","get","set","newV","initState","vm","opts","$options","initData","proxy","source","_data","initMixin","Vue","_init","options"],"mappings":"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"}