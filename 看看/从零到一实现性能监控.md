从零到一实现性能监控

#### 一、性能监控SDK的实现

数据采集的类型

- 错误信息采集
  - 自动采集
    - 资源加载错误，通过 window.addEventListener监听error的回调
    - promise调用链未捕获异常，通过 window.addEventListener监听unhandledrejection的回调
    - 对ajax, axios请求拦截，劫持open和send方法，监听readystatechange进行错误上报
  - 手动采集
    - 自定义要上传的错误信息到服务器
- 性能指标采集
  - 自动采集
    - 通过performance.getEntriesByType('paint')获取首屏和白屏数据
    - 通过performance.getEntriesByType('navigation')获取资源请求数据和页面渲染过程的数据
    - 通过performance.getEntriesByType('resource')获取资源加载的数据
    - 向下兼容，performance.timing（即将废弃）获取资源请求数据和页面渲染过程的数据
    - 通过PerformanceObserver，对异步加载的资源进行监听
    - 通过MutationObserver对异步加载的dom进行监听
  - 手动采集
    - 自定义要上传的性能数据到服务器
- 用户行为数据采集
  - 自动采集
    - 劫持`history.pushState history.replaceState`,以及监听`popstate hashchange`这两个事件,其中`popstate`事件优先
  - 手动采集
    - 自定义要上传的数据到服务器

二、数据上报给服务器，服务进行数据处理

三、可视化页面的绘制

